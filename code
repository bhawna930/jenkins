pipeline {
    agent any
    
    stages {
        stage("Build") {
            steps {
                echo 'Building project to compile and package.'
            }
        }

        stage("Unit and Integration Tests") {
            steps {
                echo 'Running JUnit tests.'
                echo 'Running Integration Tests.'
            }
            post {
                success {
                    mail to: "bhawnasharma5779@gmail.com",
                    subject: "Success: JUnit and Integration test successful.",
                    body: "Stage is working."
                }
                failure {
                    mail to: "bhawnasharma5779@gmail.com",
                    subject: "Unsuccessful: JUnit and Integration test failure.",
                    body: "Stage is not working. Please try again."
                }
            }
        }

        stage("Code Analysis") {
            steps {
                echo 'Performing code analysis.'
            }
        }

        stage("Security Scan") {
            steps {
                echo 'Performing security scan.'
            }
            post {
                success {
                    mail to: "bhawnasharma5779@gmail.com",
                    subject: "Success: Security scans successful.",
                    body: "Scan is secure."
                }
                failure {
                    mail to: "bhawnasharma5779@gmail.com",
                    subject: "Unsuccessful: Security scans failure.",
                    body: "Scan is not secure. Please protect application."
                }
            }
        }

        stage("Deploy to Staging") {
            steps {
                echo 'Deploying to staging server.'
            }
        }

        stage("Integration Tests on Staging") {
            steps {
                echo 'Running Integration Tests on Staging environment.'
            }
        }

        stage("Deploy to Production") {
            steps {
                echo 'Deploying to Production server.'
            }
        }
    }
    
    post {
        success {
            echo 'Deployment to production successful!'
        }
        failure {
            echo 'Deployment failed!'
        }
    }
}

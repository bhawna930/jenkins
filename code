pipeline {
    agent any

    stages {
        stage("Build") {
            steps {
                echo 'Building project to compile and package using Maven.'
            }
        }

        stage("Unit and Integration Tests") {
            steps {
                echo 'JUnit test for code function.'
                echo 'Integration Test working together.'
            }
        }

        stage("Code Analysis") {
            steps {
                echo 'Performing code analysis using SonarQube'
            }
        }

        stage("Security Scan") {
            steps {
                echo 'Performing security scan using SonarQube'
            }
        }

        stage("Deploy to Staging") {
            steps {
                echo 'Deploy to staging sever AWS EC2 s3://staging-bucket/'
            }
        }

        stage("Integration Tests on Staging") {
            steps {
                echo 'Run Integration Tests on Staging environment'
            }
        }

        stage("Deploy to Production") {
            steps {
                echo 'Deploy to Production server AWS EC2'
            }
        }
    }

   post {
        success {
            emailext subject: " Successful",
                      body: 'The build was successful. Congratulations!',
                      to: 'bhawnasharma5779@gmail.com',
                      attachLog: true
        }
        failure {
            emailext subject: " Failed",
                      body: 'The build has failed. Please make the necessary changes and debug ',
                      to: 'bhawnasharma5779@gmail.com',
                      attachLog: true
        }
    }
}
